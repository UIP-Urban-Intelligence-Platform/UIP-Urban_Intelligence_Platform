<!--
============================================================================
UIP - Urban Intelligence Platform
Copyright (c) 2025 UIP Team. All rights reserved.
https://github.com/UIP-Urban-Intelligence-Platform/UIP-Urban_Intelligence_Platform

SPDX-License-Identifier: MIT
============================================================================
File: apps/traffic-web-app/backend/tests/README.md
Module: Backend Tests Documentation
Author: Nguyen Nhat Quang (Lead), Nguyen Viet Hoang, Nguyen Dinh Anh Tuan
Created: 2025-11-20
Version: 1.0.0
License: MIT

Description:
  Backend tests documentation.
============================================================================
-->

/**
 * @module tests/README
 * @author Nguyễn Nhật Quang
 * @created 2025-11-27
 * @modified 2025-11-27
 * @version 1.0.0
 * @license MIT
 * 
 * @description
 * Testing Directory Index
 * 
 * This directory contains all test files organized by test type: unit tests for isolated
 * component testing, integration tests for end-to-end API testing, test data fixtures,
 * and test execution results. The structure follows professional testing best practices
 * with clear separation of concerns.
 * 
 * **Directory Structure:**
 * ```
 * tests/
 * ├── unit/         - Unit tests for individual components (via Jest in src/)
 * ├── integration/  - Integration and end-to-end API tests
 * ├── data/         - Test fixtures and mock data
 * └── results/      - Test execution results and reports
 * ```
 * 
 * @section Unit Tests (./unit/)
 * Unit tests are located alongside source code in `src/` directories using Jest.
 * See `src/routes/__tests__/` for examples.
 * 
 * @section Integration Tests (./integration/)
 * End-to-end API and agent integration tests:
 * - test-connections.js - Database and service connectivity tests
 * - test-*-endpoint.js - Individual API endpoint tests
 * - test-all-endpoints.js - Comprehensive endpoint testing
 * - test-*-agents.* - AI agent functionality tests
 * - test-enhanced-agents.ts - Enhanced agent capabilities tests
 * 
 * @section Test Data (./data/)
 * Test fixtures and mock data files:
 * - test-routing*.json - Routing algorithm test cases
 * 
 * @section Test Results (./results/)
 * Test execution results and coverage reports:
 * - test-results.txt - Test execution output
 * - Coverage reports (generated by Jest)
 * 
 * @usage
 * Run unit tests:
 * ```bash
 * npm test
 * npm run test:unit
 * ```
 * 
 * Run integration tests:
 * ```bash
 * npm run test:integration
 * npm run test:connections
 * npm run test:all
 * npm run test:agents
 * ```
 * 
 * @dependencies
 * - jest@^29.7.0 - Testing framework
 * - supertest@^6.3.3 - HTTP assertion library
 * - ts-jest@^29.1.1 - TypeScript support for Jest
 * - @types/jest@^29.5.8 - TypeScript definitions
 */

# Tests Directory

## Overview
Comprehensive testing suite including unit tests, integration tests, test data, and results.

## Structure

### `/unit` - Unit Tests
Unit tests are co-located with source code in `src/` using Jest. This directory is reserved for future standalone unit tests if needed.

**Current Location:** `src/routes/__tests__/`

**Run Unit Tests:**
```bash
npm test
npm run test:unit
```

### `/integration` - Integration Tests
End-to-end API tests and agent functionality verification.

**Available Tests:**

#### Connectivity Tests
- `test-connections.js` - Database and external service connectivity

#### API Endpoint Tests
- `test-camera-endpoint.js` - Camera API testing
- `test-weather-endpoint.js` - Weather API testing
- `test-airquality-endpoint.js` - Air Quality API testing
- `test-all-endpoints.js` - Comprehensive endpoint suite

#### Agent Tests
- `test-enhanced-agents.ts` - Enhanced AI agent capabilities
- `test-all-agents.js` - Complete agent test suite
- `test-agents-realistic.js` - Realistic agent scenarios
- `test-agents-realtime.js` - Real-time agent behavior
- `test-eco-twin-api.js` - EcoTwin agent testing
- `test-agents.ps1` - PowerShell agent test runner

#### External Integration Tests
- `test-calendar-hcmc-events.js` - HCMC events calendar integration
- `test-eventbrite-endpoint.js` - Eventbrite API integration
- `test-facebook-graph-endpoint.js` - Facebook Graph API integration
- `test-google-calendar-endpoint.js` - Google Calendar integration
- `test-google-custom-search.js` - Google Custom Search integration
- `test-hcmc-events-sources.js` - Multiple event sources
- `test-traffic-maestro-google-search.js` - Traffic Maestro search capabilities

**Run Integration Tests:**
```bash
npm run test:integration
npm run test:connections
npm run test:all
npm run test:agents
npm run test:camera
npm run test:weather
npm run test:airquality
```

### `/data` - Test Data & Fixtures
Mock data and test fixtures for routing and other scenarios.

**Available Fixtures:**
- `test-routing.json` - Standard routing test case
- `test-routing-healthiest.json` - Healthiest route optimization
- `test-routing-long.json` - Long distance routing
- `test-routing-safest.json` - Safest route optimization

### `/results` - Test Results
Test execution outputs and coverage reports.

**Generated Files:**
- `test-results.txt` - Test execution logs
- `coverage/` - Jest coverage reports (HTML, LCOV)

**View Coverage:**
```bash
npm test -- --coverage
# Open coverage/index.html in browser
```

## NPM Test Scripts

| Command | Description | Files Executed |
|---------|-------------|----------------|
| `npm test` | Run all Jest tests | All `*.test.ts` files |
| `npm run test:unit` | Unit tests only | `src/**/*.test.ts` |
| `npm run test:integration` | Integration tests | `tests/integration/**` |
| `npm run test:connections` | Connectivity tests | `test-connections.js` |
| `npm run test:camera` | Camera API tests | `test-camera-endpoint.js` |
| `npm run test:weather` | Weather API tests | `test-weather-endpoint.js` |
| `npm run test:airquality` | Air Quality tests | `test-airquality-endpoint.js` |
| `npm run test:all` | All endpoint tests | `test-all-endpoints.js` |
| `npm run test:agents` | Agent tests | `test-enhanced-agents.ts` |

## Testing Best Practices

### Unit Testing
- Test individual functions and components in isolation
- Use mocks for external dependencies
- Aim for >80% code coverage
- Place tests in `__tests__` directories near source code

### Integration Testing
- Test complete API workflows end-to-end
- Use real or staging databases when possible
- Test error scenarios and edge cases
- Verify data transformations and integrations

### Test Data Management
- Store reusable fixtures in `tests/data/`
- Use factories for dynamic test data generation
- Keep test data minimal but representative
- Don't commit sensitive data to repository

## CI/CD Integration

Tests can be integrated into CI/CD pipelines:

```yaml
# Example GitHub Actions workflow
- name: Run Tests
  run: |
    npm test -- --coverage
    npm run test:integration
```

## Adding New Tests

When adding new tests:
1. Choose appropriate directory (`unit/` or `integration/`)
2. Follow naming convention: `test-*.js` or `*.test.ts`
3. Add npm script in `package.json` if needed
4. Update this README with test description
5. Ensure tests are idempotent and independent
